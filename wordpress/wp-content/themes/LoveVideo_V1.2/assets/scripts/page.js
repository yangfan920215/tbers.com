var layout=1;window.localData={hname:location.hostname?location.hostname:"localStatus",isLocalStorage:window.localStorage?true:false,dataDom:null,initDom:function(){if(!this.dataDom){try{this.dataDom=document.createElement("input");this.dataDom.type="hidden";this.dataDom.style.display="none";this.dataDom.addBehavior("#default#userData");document.body.appendChild(this.dataDom);var B=new Date();B=B.getDate()+30;this.dataDom.expires=B.toUTCString()}catch(A){return false}}return true},set:function(A,B){if(this.isLocalStorage){window.localStorage.setItem(A,B)}else{if(this.initDom()){this.dataDom.load(this.hname);this.dataDom.setAttribute(A,B);this.dataDom.save(this.hname)}}},get:function(A){if(this.isLocalStorage){return window.localStorage.getItem(A)}else{if(this.initDom()){this.dataDom.load(this.hname);return this.dataDom.getAttribute(A)}}},remove:function(A){if(this.isLocalStorage){localStorage.removeItem(A)}else{if(this.initDom()){this.dataDom.load(this.hname);this.dataDom.removeAttribute(A);this.dataDom.save(this.hname)}}}};jQuery(document).ready(function(O){var C=localData.get("column")!=null?localData.get("column"):layout;O(".main-nav-right a").eq(C).addClass("selected");O("#postlist").get(0).className="column-"+C+" clx";if(C==1){D()}else{if(C==0){Q()}}O(".main-nav-right a,.likeButton,.viewsButton").colorTip({});O(".main-nav-right a").click(function(E){E.preventDefault();E.returnValue=false;if(!O(this).hasClass("selected")){var B=O(this),S=O(".main-nav-right a").index(B);O(".main-nav-right a.selected").removeClass("selected");B.addClass("selected");localData.set("column",S);O("#postlist").get(0).className="column-"+S+" clx";O(".pin").addClass("transform");if(S==1){D()}else{if(S==0){Q()}else{return false}}}return false});if(O(".film img").length>0&&O("#filmstrip")!=null){var A=O(".film"),N=O("#filmstrip-left ul li"),F=O("#filmstrip-right ul li a"),K=A.length-1,G=new Image(),L,P=function(B){var E=B.attr("original");if(E!=undefined){B.attr("src",E).removeAttr("original")}},I=function(){var E=A.index(O(".film.current")),B=E<K?(E+1):0;F.eq(B).click()};A.hide();N.eq(0).show();G.onload=function(){P(A.eq(0).children("img"));P(A.eq(1).children("img"));O("#filmstrip-footer").animate({bottom:0},600);A.eq(0).addClass("current").fadeIn(600);O("#filmstrip").css({background:"#fff"});F.eq(0).addClass("current");L=setInterval(I,6000)};G.src=A.eq(0).children("img").attr("original");F.click(function(E){E.preventDefault();E.returnValue=false;var B=O(this);if(!B.hasClass("current")){var T=F.index(B),S=T<K?(T+1):0,U=O(".film.current"),W=O("#filmstrip-right ul li a.current"),V=A.eq(T);P(A.eq(T).children("img"));P(A.eq(S).children("img"));W.removeClass("current");U.removeClass("current").fadeOut();V.addClass("current").fadeIn();O(this).addClass("current");N.hide();N.eq(T).show()}return false});O("#filmstrip").hover(function(){clearInterval(L);L=null},function(){clearInterval(L);L=null;L=setInterval(I,6000)})}var M=O(window),H=M.width();J(0);M.resize(function(){if(O(this).width()==H){return false}H=O(this).width();J(M.scrollTop());return false}).scroll(function(){J(M.scrollTop())});function J(B){O(".imageLink img").each(function(){var V=O(this).offset().top,E=M.height()+B;if(V<E){var U=O(this).attr("original");if(U!=undefined){O(this).attr("src",U).removeAttr("original").addClass("lazy").parent().removeClass("loading")}else{O(this).addClass("lazy").parent().removeClass("loading")}}else{var U=O(this).attr("original");if(U!=undefined){O(this).attr("src",U).removeAttr("original")}return false}})}function Q(){O(".image img").each(function(){var B=O(this),V=B.attr("src"),E=B.attr("oriheight"),T=B.attr("src"),U=B.attr("original");if(U!=undefined){U=U.replace("_150.jpg","_150.jpg");B.attr({"original":U,"height":150})}else{T=T.replace("_150.jpg","_150.jpg");B.attr({"src":T,"height":150})}});O(".pin").removeClass("stack").css({top:"",left:"",position:""});O("#postlist").css({height:""})}function D(){O(".image img").each(function(){var B=O(this),V=B.attr("src"),E=B.attr("oriheight"),T=B.attr("src"),U=B.attr("original");if(U!=undefined){U=U.replace("_150.jpg","_150.jpg");B.attr({"original":U,"height":E})}else{T=T.replace("_150.jpg","_150.jpg");B.attr({"src":T,"height":E})}});R()}function R(){var E=[0,0,0],B=O("#postlist");B.children().not(".stack").each(function(){var S=O(this),T=O.inArray(Math.min.apply(Math,E),E);S.css({left:T*S.outerWidth(true),top:E[T],position:"absolute"}).addClass("stack");E[T]+=S.outerHeight(true)});B.css("height",Math.max.apply(Math,E))}});